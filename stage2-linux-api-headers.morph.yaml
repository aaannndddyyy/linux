name: stage2-linux-api-headers
kind: chunk

install-commands:
    - make mrproper

    # There must be a better way to divine Linux architecture from GNU
    # machine triplet, but I don't know of it ... 
    # FIXME: see what the major distros do!
    - |
      cpu=$(echo $TARGET | cut -d '-' -f 1)
      case $cpu in
          "") echo "Invalid target for stage 2: '$TARGET'"; false ;;
          i?86) export ARCH=i386 ;;
          arm*) export ARCH=arm ;;
          *) export ARCH="$cpu" ;;
      esac
      make INSTALL_HDR_PATH=dest headers_install
    - install -d "$DESTDIR${PREFIX-/usr}/include"
    - cp -r dest/include/* "$DESTDIR/${PREFIX-/usr}/include"
